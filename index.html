<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ò–≥—Ä–∞</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white;
            min-height: 100vh;
            overflow: hidden;
            position: relative;
        }
        
        .container {
            max-width: 100%;
            padding: 10px;
        }
        
        .header {
            text-align: center;
            padding: 15px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 15px;
            margin-bottom: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            border: 2px solid #4cc9f0;
        }
        
        .header h1 {
            font-size: 1.8rem;
            background: linear-gradient(90deg, #4cc9f0, #f72585);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 5px;
        }
        
        .score-container {
            display: flex;
            justify-content: space-around;
            margin-top: 10px;
        }
        
        .score-box {
            background: rgba(0, 0, 0, 0.6);
            padding: 10px 15px;
            border-radius: 10px;
            min-width: 100px;
            text-align: center;
            border: 1px solid;
            transition: all 0.3s;
        }
        
        #strength-box {
            border-color: #ff6b6b;
        }
        
        #agility-box {
            border-color: #4ecdc4;
        }
        
        #intelligence-box {
            border-color: #ffe66d;
        }
        
        .score-value {
            font-size: 2rem;
            font-weight: bold;
        }
        
        .score-label {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-top: 5px;
        }
        
        .game-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 10px;
            position: relative;
        }
        
        .panels-container {
            display: flex;
            justify-content: space-around;
            width: 100%;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .panel {
            width: 30%;
            min-width: 100px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(5px);
            border: 2px solid;
            transition: all 0.3s;
            position: relative;
            cursor: pointer;
            margin-bottom: 10px;
        }
        
        .panel:hover {
            transform: translateY(-5px);
        }
        
        .panel-1 {
            border-color: #ff6b6b;
        }
        
        .panel-2 {
            border-color: #4ecdc4;
        }
        
        .panel-3 {
            border-color: #ffe66d;
        }
        
        .panel-image {
            width: 70px;
            height: 70px;
            margin: 0 auto 15px;
            border-radius: 50%;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            border: 3px solid;
        }
        
        .panel-1 .panel-image {
            background: rgba(255, 107, 107, 0.2);
            border-color: #ff6b6b;
        }
        
        .panel-2 .panel-image {
            background: rgba(78, 205, 196, 0.2);
            border-color: #4ecdc4;
        }
        
        .panel-3 .panel-image {
            background: rgba(255, 230, 109, 0.2);
            border-color: #ffe66d;
        }
        
        .panel-value {
            font-size: 2.5rem;
            font-weight: bold;
            margin: 10px 0;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
        }
        
        .panel-label {
            font-size: 1rem;
            opacity: 0.9;
        }
        
        .character-container {
            width: 200px;
            height: 300px;
            position: relative;
            margin: 20px auto;
            perspective: 1000px;
        }
        
        .character-3d {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.5s;
        }
        
        .character-body {
            position: absolute;
            width: 80px;
            height: 120px;
            background: linear-gradient(to bottom, #4361ee, #3a0ca3);
            border-radius: 40px 40px 10px 10px;
            top: 100px;
            left: 60px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
        }
        
        .character-head {
            position: absolute;
            width: 60px;
            height: 60px;
            background: linear-gradient(to bottom, #ffd6ff, #e7c6ff);
            border-radius: 50%;
            top: 40px;
            left: 70px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .character-arm-left {
            position: absolute;
            width: 20px;
            height: 80px;
            background: linear-gradient(to bottom, #4361ee, #3a0ca3);
            border-radius: 10px;
            top: 110px;
            left: 40px;
            transform-origin: top center;
            animation: waveArmLeft 2s infinite alternate;
        }
        
        .character-arm-right {
            position: absolute;
            width: 20px;
            height: 80px;
            background: linear-gradient(to bottom, #4361ee, #3a0ca3);
            border-radius: 10px;
            top: 110px;
            left: 140px;
            transform-origin: top center;
            animation: waveArmRight 2s infinite alternate-reverse;
        }
        
        .character-leg-left {
            position: absolute;
            width: 25px;
            height: 100px;
            background: linear-gradient(to bottom, #7209b7, #560bad);
            border-radius: 10px;
            top: 220px;
            left: 80px;
        }
        
        .character-leg-right {
            position: absolute;
            width: 25px;
            height: 100px;
            background: linear-gradient(to bottom, #7209b7, #560bad);
            border-radius: 10px;
            top: 220px;
            left: 95px;
        }
        
        .weapon {
            position: absolute;
            width: 80px;
            height: 10px;
            background: #333;
            border-radius: 5px;
            top: 130px;
            left: 160px;
            transform: rotate(15deg);
            z-index: 10;
        }
        
        .weapon::after {
            content: '';
            position: absolute;
            width: 30px;
            height: 10px;
            background: #666;
            border-radius: 5px;
            right: -30px;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn-shoot {
            background: linear-gradient(90deg, #ff6b6b, #ff8e8e);
            color: white;
        }
        
        .btn-shoot:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(255, 107, 107, 0.7);
        }
        
        .btn-upgrade {
            background: linear-gradient(90deg, #4ecdc4, #6fffe0);
            color: #1a1a2e;
        }
        
        .btn-upgrade:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(78, 205, 196, 0.7);
        }
        
        .bullet {
            position: absolute;
            width: 8px;
            height: 8px;
            background: yellow;
            border-radius: 50%;
            box-shadow: 0 0 10px yellow;
            z-index: 100;
            display: none;
        }
        
        .hit-effect {
            position: absolute;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255,255,0,0.8) 0%, rgba(255,255,0,0) 70%);
            pointer-events: none;
            display: none;
            z-index: 90;
        }
        
        .stats {
            background: rgba(0, 0, 0, 0.6);
            border-radius: 15px;
            padding: 15px;
            margin-top: 20px;
            width: 100%;
            text-align: center;
            border: 1px solid #4cc9f0;
        }
        
        .stats h3 {
            margin-bottom: 10px;
            color: #4cc9f0;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }
        
        .stat-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 10px;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #f72585;
        }
        
        .upgrade-cost {
            font-size: 0.8rem;
            opacity: 0.8;
            margin-top: 5px;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            border-left: 5px solid #4cc9f0;
            transform: translateX(120%);
            transition: transform 0.5s;
            z-index: 1000;
            max-width: 300px;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        @keyframes waveArmLeft {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(-30deg); }
        }
        
        @keyframes waveArmRight {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(30deg); }
        }
        
        @keyframes shoot {
            0% { transform: translateX(0) translateY(0); }
            100% { transform: translateX(300px) translateY(var(--random-y)); }
        }
        
        @media (max-width: 768px) {
            .panels-container {
                flex-direction: column;
                align-items: center;
            }
            
            .panel {
                width: 90%;
                margin-bottom: 15px;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 90%;
            }
            
            .character-container {
                width: 150px;
                height: 250px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>3D –ü–ê–†–ê–ú–ï–¢–†–´ –°–¢–†–ï–õ–Ø–õ–ö–ê</h1>
            <p>–°—Ç—Ä–µ–ª—è–π –≤ –ø–∞–Ω–µ–ª–∏, —É–ª—É—á—à–∞–π –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –∫–∞—á–∞–π –ø–µ—Ä—Å–æ–Ω–∞–∂–∞!</p>
            
            <div class="score-container">
                <div class="score-box" id="strength-box">
                    <div class="score-value" id="strength-value">100</div>
                    <div class="score-label">–°–ò–õ–ê</div>
                </div>
                <div class="score-box" id="agility-box">
                    <div class="score-value" id="agility-value">100</div>
                    <div class="score-label">–õ–û–í–ö–û–°–¢–¨</div>
                </div>
                <div class="score-box" id="intelligence-box">
                    <div class="score-value" id="intelligence-value">100</div>
                    <div class="score-label">–ò–ù–¢–ï–õ–õ–ï–ö–¢</div>
                </div>
            </div>
        </div>
        
        <div class="game-area">
            <div class="panels-container">
                <div class="panel panel-1" id="panel-1">
                    <div class="panel-image">üí™</div>
                    <div class="panel-value" id="panel-1-value">-3</div>
                    <div class="panel-label">–°–ò–õ–ê</div>
                </div>
                
                <div class="panel panel-2" id="panel-2">
                    <div class="panel-image">üèÉ</div>
                    <div class="panel-value" id="panel-2-value">+100</div>
                    <div class="panel-label">–õ–û–í–ö–û–°–¢–¨</div>
                </div>
                
                <div class="panel panel-3" id="panel-3">
                    <div class="panel-image">üß†</div>
                    <div class="panel-value" id="panel-3-value">+200</div>
                    <div class="panel-label">–ò–ù–¢–ï–õ–õ–ï–ö–¢</div>
                </div>
            </div>
            
            <div class="character-container">
                <div class="character-3d" id="character-3d">
                    <div class="character-head"></div>
                    <div class="character-body"></div>
                    <div class="character-arm-left"></div>
                    <div class="character-arm-right"></div>
                    <div class="character-leg-left"></div>
                    <div class="character-leg-right"></div>
                    <div class="weapon"></div>
                </div>
            </div>
            
            <div class="bullet" id="bullet"></div>
            
            <div class="controls">
                <button class="btn btn-shoot" id="shoot-btn">
                    <span>üî´</span> –°–¢–†–ï–õ–Ø–¢–¨ –í –ü–ê–ù–ï–õ–ò
                </button>
                <button class="btn btn-upgrade" id="upgrade-btn">
                    <span>‚ö°</span> –£–õ–£–ß–®–ò–¢–¨ –û–†–£–ñ–ò–ï (50 –æ—á–∫–æ–≤)
                </button>
            </div>
            
            <div class="stats">
                <h3>–°–¢–ê–¢–ò–°–¢–ò–ö–ê –ò–ì–†–´</h3>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div>–í—ã—Å—Ç—Ä–µ–ª—ã</div>
                        <div class="stat-value" id="shots-count">0</div>
                    </div>
                    <div class="stat-item">
                        <div>–ü–æ–ø–∞–¥–∞–Ω–∏—è</div>
                        <div class="stat-value" id="hits-count">0</div>
                    </div>
                    <div class="stat-item">
                        <div>–£—Ä–æ–≤–µ–Ω—å –æ—Ä—É–∂–∏—è</div>
                        <div class="stat-value" id="weapon-level">1</div>
                        <div class="upgrade-cost" id="upgrade-cost">–°–ª–µ–¥—É—é—â–∏–π: 50</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="notification" id="notification">
        <div id="notification-text">–¢–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ</div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        let tg = window.Telegram.WebApp;
        tg.expand();
        tg.MainButton.setText("–ú–ï–ù–Æ –ò–ì–†–´").show();
        
        // –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let gameState = {
            strength: 100,
            agility: 100,
            intelligence: 100,
            shots: 0,
            hits: 0,
            weaponLevel: 1,
            upgradeCost: 50,
            points: 0,
            panelValues: {
                panel1: -3,
                panel2: 100,
                panel3: 200
            }
        };
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const strengthValue = document.getElementById('strength-value');
        const agilityValue = document.getElementById('agility-value');
        const intelligenceValue = document.getElementById('intelligence-value');
        const panel1Value = document.getElementById('panel-1-value');
        const panel2Value = document.getElementById('panel-2-value');
        const panel3Value = document.getElementById('panel-3-value');
        const shotsCount = document.getElementById('shots-count');
        const hitsCount = document.getElementById('hits-count');
        const weaponLevel = document.getElementById('weapon-level');
        const upgradeCost = document.getElementById('upgrade-cost');
        const shootBtn = document.getElementById('shoot-btn');
        const upgradeBtn = document.getElementById('upgrade-btn');
        const bullet = document.getElementById('bullet');
        const character3d = document.getElementById('character-3d');
        const notification = document.getElementById('notification');
        const notificationText = document.getElementById('notification-text');
        const panels = document.querySelectorAll('.panel');
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–Ω–∞—á–µ–Ω–∏–π
        function initGame() {
            updateUI();
            generateNewPanelValues();
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
            const savedState = localStorage.getItem('3dParamsGameState');
            if (savedState) {
                const parsedState = JSON.parse(savedState);
                gameState = {...gameState, ...parsedState};
                updateUI();
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —É–ª—É—á—à–µ–Ω–∏—è
            upgradeCost.textContent = `–°–ª–µ–¥—É—é—â–∏–π: ${gameState.upgradeCost}`;
            upgradeBtn.innerHTML = `<span>‚ö°</span> –£–õ–£–ß–®–ò–¢–¨ –û–†–£–ñ–ò–ï (${gameState.upgradeCost} –æ—á–∫–æ–≤)`;
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function updateUI() {
            strengthValue.textContent = gameState.strength;
            agilityValue.textContent = gameState.agility;
            intelligenceValue.textContent = gameState.intelligence;
            
            shotsCount.textContent = gameState.shots;
            hitsCount.textContent = gameState.hits;
            weaponLevel.textContent = gameState.weaponLevel;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–µ–≥–æ –≤–∏–¥–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
            updateCharacterAppearance();
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä—ã
            localStorage.setItem('3dParamsGameState', JSON.stringify(gameState));
        }
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –ø–∞–Ω–µ–ª–µ–π
        function generateNewPanelValues() {
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞–Ω–µ–ª–∏
            gameState.panelValues.panel1 = getRandomPanelValue();
            gameState.panelValues.panel2 = getRandomPanelValue();
            gameState.panelValues.panel3 = getRandomPanelValue();
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π
            panel1Value.textContent = formatPanelValue(gameState.panelValues.panel1);
            panel2Value.textContent = formatPanelValue(gameState.panelValues.panel2);
            panel3Value.textContent = formatPanelValue(gameState.panelValues.panel3);
        }
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –ø–∞–Ω–µ–ª–∏
        function getRandomPanelValue() {
            const values = [-10, -5, -3, -2, -1, 1, 2, 5, 10, 20, 50, 100, 200];
            const weights = [3, 4, 5, 6, 8, 10, 12, 15, 10, 8, 6, 4, 2];
            
            let totalWeight = weights.reduce((a, b) => a + b, 0);
            let random = Math.random() * totalWeight;
            
            for (let i = 0; i < values.length; i++) {
                random -= weights[i];
                if (random <= 0) {
                    return values[i];
                }
            }
            
            return 10; // fallback
        }
        
        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–∞–Ω–µ–ª–∏
        function formatPanelValue(value) {
            return value > 0 ? `+${value}` : value;
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–µ–≥–æ –≤–∏–¥–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
        function updateCharacterAppearance() {
            // –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–∏–ª—ã
            const strengthScale = 1 + (gameState.strength - 100) / 500;
            character3d.style.transform = `scale(${strengthScale})`;
            
            // –¶–≤–µ—Ç –æ—Ä—É–∂–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Ä–æ–≤–Ω—è
            const weapon = document.querySelector('.weapon');
            if (gameState.weaponLevel >= 5) {
                weapon.style.background = 'linear-gradient(90deg, #ffd700, #ffaa00)';
            } else if (gameState.weaponLevel >= 3) {
                weapon.style.background = 'linear-gradient(90deg, #c0c0c0, #a0a0a0)';
            }
            
            // –ê–Ω–∏–º–∞—Ü–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ª–æ–≤–∫–æ—Å—Ç–∏
            const arms = document.querySelectorAll('.character-arm-left, .character-arm-right');
            arms.forEach(arm => {
                const speed = 2 - (gameState.agility - 100) / 500;
                arm.style.animationDuration = `${speed}s`;
            });
        }
        
        // –°—Ç—Ä–µ–ª—å–±–∞ –ø–æ –ø–∞–Ω–µ–ª—è–º
        function shootAtPanel(panelIndex) {
            gameState.shots++;
            
            // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–µ–ª–∏
            let targetPanel;
            let panelValue;
            
            switch(panelIndex) {
                case 1:
                    targetPanel = document.getElementById('panel-1');
                    panelValue = gameState.panelValues.panel1;
                    break;
                case 2:
                    targetPanel = document.getElementById('panel-2');
                    panelValue = gameState.panelValues.panel2;
                    break;
                case 3:
                    targetPanel = document.getElementById('panel-3');
                    panelValue = gameState.panelValues.panel3;
                    break;
            }
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –≤—ã—Å—Ç—Ä–µ–ª–∞
            animateBullet(targetPanel, panelIndex);
            
            // –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –ø–∞–Ω–µ–ª–∏
            setTimeout(() => {
                applyPanelEffect(panelIndex, panelValue);
                gameState.hits++;
                updateUI();
                
                // –ü–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                showNotification(`–ü–æ–ø–∞–¥–∞–Ω–∏–µ! –ü–æ–ª—É—á–µ–Ω–æ: ${formatPanelValue(panelValue)}`, panelIndex);
                
                // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –≤—Å–µ—Ö –ø–∞–Ω–µ–ª–µ–π
                generateNewPanelValues();
                
                // –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –æ—á–∫–æ–≤
                gameState.points += Math.abs(panelValue);
                
            }, 600);
        }
        
        // –ê–Ω–∏–º–∞—Ü–∏—è –ø—É–ª–∏
        function animateBullet(targetPanel, panelIndex) {
            const characterRect = character3d.getBoundingClientRect();
            const panelRect = targetPanel.getBoundingClientRect();
            
            // –ü–æ–∑–∏—Ü–∏—è –ø—É–ª–∏
            const startX = characterRect.left + characterRect.width;
            const startY = characterRect.top + characterRect.height / 2;
            
            const endX = panelRect.left + panelRect.width / 2;
            const endY = panelRect.top + panelRect.height / 2;
            
            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞—á–∞–ª—å–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏
            bullet.style.left = `${startX}px`;
            bullet.style.top = `${startY}px`;
            bullet.style.display = 'block';
            
            // –†–∞—Å—á–µ—Ç —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏
            const deltaX = endX - startX;
            const deltaY = endY - startY;
            const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
            
            // –ê–Ω–∏–º–∞—Ü–∏—è
            bullet.style.transition = `transform 0.5s linear`;
            bullet.style.transform = `translate(${deltaX}px, ${deltaY}px)`;
            
            // –°–∫—Ä—ã—Ç–∏–µ –ø—É–ª–∏ –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
            setTimeout(() => {
                bullet.style.display = 'none';
                bullet.style.transform = 'translate(0, 0)';
            }, 500);
        }
        
        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∞ –ø–∞–Ω–µ–ª–∏
        function applyPanelEffect(panelIndex, value) {
            switch(panelIndex) {
                case 1: // –°–∏–ª–∞
                    gameState.strength += value;
                    if (gameState.strength < 1) gameState.strength = 1;
                    break;
                case 2: // –õ–æ–≤–∫–æ—Å—Ç—å
                    gameState.agility += value;
                    if (gameState.agility < 1) gameState.agility = 1;
                    break;
                case 3: // –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç
                    gameState.intelligence += value;
                    if (gameState.intelligence < 1) gameState.intelligence = 1;
                    break;
            }
        }
        
        // –£–ª—É—á—à–µ–Ω–∏–µ –æ—Ä—É–∂–∏—è
        function upgradeWeapon() {
            if (gameState.points >= gameState.upgradeCost) {
                gameState.points -= gameState.upgradeCost;
                gameState.weaponLevel++;
                
                // –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Å–ª–µ–¥—É—é—â–µ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è
                gameState.upgradeCost = Math.floor(gameState.upgradeCost * 1.5);
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ —É–ª—É—á—à–µ–Ω–∏—è
                upgradeBtn.innerHTML = `<span>‚ö°</span> –£–õ–£–ß–®–ò–¢–¨ –û–†–£–ñ–ò–ï (${gameState.upgradeCost} –æ—á–∫–æ–≤)`;
                upgradeCost.textContent = `–°–ª–µ–¥—É—é—â–∏–π: ${gameState.upgradeCost}`;
                
                // –ü–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                showNotification(`–û—Ä—É–∂–∏–µ —É–ª—É—á—à–µ–Ω–æ –¥–æ —É—Ä–æ–≤–Ω—è ${gameState.weaponLevel}!`, 'upgrade');
                
                updateUI();
            } else {
                showNotification(`–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ—á–∫–æ–≤! –ù—É–∂–Ω–æ: ${gameState.upgradeCost}`, 'error');
            }
        }
        
        // –ü–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function showNotification(message, type) {
            notificationText.textContent = message;
            
            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–≤–µ—Ç–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞
            if (type === 1) {
                notification.style.borderLeftColor = '#ff6b6b';
            } else if (type === 2) {
                notification.style.borderLeftColor = '#4ecdc4';
            } else if (type === 3) {
                notification.style.borderLeftColor = '#ffe66d';
            } else if (type === 'upgrade') {
                notification.style.borderLeftColor = '#4cc9f0';
            } else if (type === 'error') {
                notification.style.borderLeftColor = '#f72585';
            }
            
            notification.classList.add('show');
            
            // –°–∫—Ä—ã—Ç–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // –°–ª—É—á–∞–π–Ω–∞—è —Å—Ç—Ä–µ–ª—å–±–∞ –ø–æ –ø–∞–Ω–µ–ª—è–º –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏
        function randomShoot() {
            const randomPanel = Math.floor(Math.random() * 3) + 1;
            shootAtPanel(randomPanel);
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        shootBtn.addEventListener('click', randomShoot);
        
        upgradeBtn.addEventListener('click', upgradeWeapon);
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–ª–∏–∫–æ–≤ –ø–æ –ø–∞–Ω–µ–ª—è–º
        panels.forEach((panel, index) => {
            panel.addEventListener('click', () => {
                shootAtPanel(index + 1);
            });
        });
        
        // –ö–Ω–æ–ø–∫–∞ –º–µ–Ω—é –≤ Telegram
        tg.MainButton.onClick(function() {
            showNotification(`–°–∏–ª–∞: ${gameState.strength} | –õ–æ–≤–∫–æ—Å—Ç—å: ${gameState.agility} | –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç: ${gameState.intelligence}`, 'upgrade');
        });
        
        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', initGame);
        
        // –ë–µ—Å–∫–æ–Ω–µ—á–Ω–∞—è –∏–≥—Ä–∞ - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
        setInterval(() => {
            if (Math.random() > 0.7) { // 30% chance
                generateNewPanelValues();
                showNotification('–ó–Ω–∞—á–µ–Ω–∏—è –Ω–∞ –ø–∞–Ω–µ–ª—è—Ö –æ–±–Ω–æ–≤–ª–µ–Ω—ã!', 'upgrade');
            }
        }, 10000);
    </script>
</body>
</html>
